import{r as t,h as s,H as i,g as e}from"./p-70d5d065.js";const h=class{constructor(s){t(this,s),this.hasInstructions=!1,this.hasSuccess=!1,this.hasError=!1,this.acceptImage=!0,this.acceptPdf=!1,this.assetName="image",this.avatar=!1,this.thumbnailSize="cover",this.isUploaded=!1,this.isUploading=!1,this.removeButtonLabel="Remove",this.showButton=!0,this.showIcon=!0,this.showDropzoneText=!0,this.uploadButtonLabel="Upload",this.isDraggingOver=!1,this.isFileSelected=!1}onThumbnailUrlChange(){this.thumbnailUrl&&(this.isUploaded=!0)}connectedCallback(){this.onThumbnailUrlChange()}componentWillRender(){this.hasInstructions=!!this.element.querySelector('[slot="instructions"]'),this.hasSuccess=!!this.element.querySelector('[slot="success"]'),this.hasError=!!this.element.querySelector('[slot="error"]')}async removeFile(){this.hasFile&&!this.isUploading&&(this.isFileSelected=!1,this.isUploaded=!1,this.isUploading=!1,this.fileInput.value="",this.fileInput.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0})),this.fileInput.dispatchEvent(new Event("input",{bubbles:!0,cancelable:!0})))}async selectFile(){this.hasFile||(this.isFileSelected=!1,this.fileInput.value="",this.fileInput.click())}onButtonClick(t){t.stopPropagation(),t.preventDefault(),this.isUploading||(this.hasFile?this.removeFile():this.selectFile())}onInput(t){this.isFileSelected=t.target.files&&t.target.files.length>0,this.isFileSelected?this.setThumnailDataUri(t.target.files[0]):this.thumbnailDataUri=null}setThumnailDataUri(t){if(this.thumbnailDataUri=null,!/\.(jpe?g|png|gif)$/i.test(t.name))return;const s=new FileReader;s.onload=()=>{this.thumbnailDataUri=s.result},s.readAsDataURL(t)}onDragOver(){this.isDraggingOver=!0}onDragLeave(){this.isDraggingOver=!1}get accept(){let t=[];return this.acceptImage&&t.push("image/*"),this.acceptPdf&&t.push(".pdf"),t.join(",")||null}get dropzoneWidth(){return this.width?this.width:this.avatar?"80px":"308px"}get dropzoneHeight(){return this.height?this.height:this.avatar?"80px":"auto"}get dropzoneClass(){let t="dropzone relative w-full h-full px-16 rounded-2xl overflow-hidden";return this.hasFile&&(t+=" opacity-0"),this.isDraggingOver&&(t+=" drag-over"),t+=this.showIcon&&this.showDropzoneText?" py-24":" py-16",t}get hasFile(){return this.isFileSelected||this.isUploaded}get thumbnailBackgroundImage(){let t=this.thumbnailUrl;return this.isFileSelected&&(t=this.thumbnailDataUri),t?`url(${t})`:null}get thumbnailBackgroundSize(){return["contain","cover","auto","stretch"].includes(this.thumbnailSize)?"stretch"===this.thumbnailSize?"100% 100%":this.thumbnailSize:"cover"}render(){let t;return t=s("i",this.icon?{"data-testid":"upload-icon",class:"dropzone-icon "+this.icon}:this.avatar?{"data-testid":"avatar-icon",class:"mds-user-circle text-icon"}:{"data-testid":"image-icon",class:"mds-image text-icon"+(this.showDropzoneText?" mb-8":"")}),s(i,{class:"mx-image-upload inline-block",style:{width:this.dropzoneWidth}},s("div",{"data-testid":"dropzone-wrapper",class:"dropzone-wrapper flex w-full items-center justify-center relative rounded-2xl text-3 overflow-hidden",style:{height:this.dropzoneHeight}},s("div",{class:this.dropzoneClass},s("div",{class:"flex flex-col items-center justify-center w-full h-full"},this.showIcon&&t,s("slot",{name:"dropzone-text"},s("div",{"data-testid":"dropzone-text",class:"text-center"+(this.showDropzoneText&&!this.avatar?"":" hidden")},s("p",{class:"subtitle1 my-0"},"No ",this.assetName," to show"),s("p",{class:"text-4 my-0 mt-4"},"Click to add ",this.assetName)))),s("svg",{class:"dashed-border absolute inset-0 pointer-events-none",width:"100%",height:"100%"},s("rect",{width:"100%",height:"100%",fill:"none",rx:"16",ry:"16","stroke-width":"1","stroke-dasharray":"4,8"})),s("input",{ref:t=>this.fileInput=t,id:this.inputId,name:this.name,type:"file",accept:this.accept,class:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",onInput:this.onInput.bind(this),onDragOver:this.onDragOver.bind(this),onDragLeave:this.onDragLeave.bind(this),onDrop:this.onDragLeave.bind(this)})),this.hasFile&&this.thumbnailBackgroundImage&&s("div",{"data-testid":"thumbnail",class:"thumbnail absolute inset-0 bg-center bg-no-repeat pointer-events-none",style:{backgroundImage:this.thumbnailBackgroundImage,backgroundSize:this.thumbnailBackgroundSize}}),s("div",{"data-testid":"uploaded",class:"flex items-center justify-center absolute inset-0 pointer-events-none "+(this.isUploaded?"":" hidden")},s("slot",{name:"uploaded"})),this.isUploading&&s("div",{"data-testid":"progress",class:"uploading-progress flex items-center justify-center opacity-50 absolute inset-0"},s("mx-circular-progress",{size:"2rem"}))),this.showButton&&s("mx-button",{"data-testid":"upload-button",class:"mt-16",btnType:this.hasFile&&!this.isUploading?"outlined":"contained",onClick:this.onButtonClick.bind(this),disabled:this.isUploading},this.hasFile&&!this.isUploading?this.removeButtonLabel:this.uploadButtonLabel),this.hasInstructions&&s("p",{class:"caption1 my-16"},s("slot",{name:"instructions"})),this.hasSuccess&&s("p",{class:"upload-success caption1 my-16"},s("slot",{name:"success"})),this.hasError&&s("p",{class:"upload-error caption1 my-16"},s("slot",{name:"error"})))}get element(){return e(this)}static get watchers(){return{thumbnailUrl:["onThumbnailUrlChange"]}}};export{h as mx_image_upload}