import{r as t,h as s,H as i,g as e}from"./p-70d5d065.js";import{l as a,u as h}from"./p-2c153f67.js";import{m as n}from"./p-765f57ba.js";import{f as l,d as r,b as o}from"./p-2bd2025a.js";import"./p-0d6b3f5b.js";const c=class{constructor(s){t(this,s),this.isVisible=!1}onKeyDown(t){if(!this.isVisible)return;const s=()=>!document.activeElement||!this.focusElements.includes(document.activeElement);"Tab"===t.key?(this.getFocusElements(),t.shiftKey&&document.activeElement===this.firstFocusElement?(this.lastFocusElement.focus(),t.preventDefault()):(s()||document.activeElement===this.lastFocusElement)&&(this.firstFocusElement&&this.firstFocusElement.focus(),t.preventDefault())):"Enter"===t.key?(this.getFocusElements(),s()&&(t.preventDefault(),this.firstFocusElement&&this.firstFocusElement.focus(),this.closeDialog(!0))):"Escape"===t.key&&(this.closeDialog(),t.preventDefault())}async alert(t,{confirmLabel:s="Okay",cancelLabel:i,heading:e}={}){return this.open(t,{heading:e,confirmLabel:s,cancelLabel:i})}async confirm(t,{confirmLabel:s="Okay",cancelLabel:i="Cancel",heading:e}={}){return this.open(t,{heading:e,confirmLabel:s,cancelLabel:i})}disconnectedCallback(){h(this.element)}async open(t,{cancelLabel:s,confirmLabel:i,heading:e}={}){return this.heading=e,this.message=t,this.cancelLabel=s,this.confirmLabel=i,this.showDialog(),new Promise((t=>{this.deferredResolve=t}))}async showDialog(){this.ancestorFocusedElement=document.activeElement,n(this.element),a(this.element),this.isVisible=!0,await new Promise((t=>requestAnimationFrame(t))),await Promise.all([l(this.backdrop),r(this.modal)])}async closeDialog(t=!1){await Promise.all([o(this.backdrop),o(this.modal)]),this.isVisible=!1,h(this.element),this.ancestorFocusedElement&&this.ancestorFocusedElement.focus(),this.deferredResolve(t)}getFocusElements(){this.focusElements=Array.from(this.element.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')).filter((t=>!!t.offsetParent)),this.focusElements.length&&(this.firstFocusElement=this.focusElements[0],this.lastFocusElement=this.focusElements[this.focusElements.length-1])}get hostClass(){let t="mx-dialog fixed inset-0 flex items-center justify-center";return this.isVisible||(t+=" hidden"),t}render(){return s(i,{class:this.hostClass},s("div",{ref:t=>this.backdrop=t,class:"bg-dialog-backdrop absolute inset-0 z-0"}),s("div",{ref:t=>this.modal=t,role:"alertdialog","aria-labelledby":this.heading?"dialog-heading":null,"aria-describedby":this.message?"dialog-message":null,"aria-modal":"true","data-testid":"modal",class:"modal w-320 flex flex-col rounded-lg shadow-4 relative overflow-hidden"},s("div",{class:"p-24 flex-grow"},this.heading&&s("h1",{id:"dialog-heading",class:"text-h6 emphasis !my-0 pb-16"},this.heading),this.message&&s("p",{id:"dialog-message",class:"text-4 my-0"},this.message)),(this.confirmLabel||this.cancelLabel)&&s("div",{class:"flex flex-wrap items-center justify-end p-4"},this.confirmLabel&&s("mx-button",{class:"m-4 order-2",btnType:"text",onClick:()=>this.closeDialog(!0)},this.confirmLabel),this.cancelLabel&&s("mx-button",{class:"m-4 order-1",btnType:"text",onClick:()=>this.closeDialog()},this.cancelLabel))))}get element(){return e(this)}};export{c as mx_dialog}